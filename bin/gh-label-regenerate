#!/bin/bash

echo ''
echo 'This script will remove the GitHub default labels and create more useful'
echo 'labels for your repo.'
echo 'A personal access token is required to access private repos.'
echo "Be sure there is a file with token inside in $HOME/.dotsecret/github-token.txt"
echo 'You can generate your token here: https://github.com/settings/tokens/new'

while read line; do
    TOKEN=$line
done <"$HOME/.dotsecret/github-token.txt"

echo ''
echo 'GitHub Org/Repo (e.g. foo/bar): '
read REPO

REPO_USER=$(echo "$REPO" | cut -f1 -d /)
REPO_NAME=$(echo "$REPO" | cut -f2 -d /)

# Delete default labels
curl -u $TOKEN:x-oauth-basic --request DELETE https://api.github.com/repos/$REPO_USER/$REPO_NAME/labels/bug
curl -u $TOKEN:x-oauth-basic --request DELETE https://api.github.com/repos/$REPO_USER/$REPO_NAME/labels/duplicate
curl -u $TOKEN:x-oauth-basic --request DELETE https://api.github.com/repos/$REPO_USER/$REPO_NAME/labels/enhancement
curl -u $TOKEN:x-oauth-basic --request DELETE https://api.github.com/repos/$REPO_USER/$REPO_NAME/labels/help%20wanted
curl -u $TOKEN:x-oauth-basic --request DELETE https://api.github.com/repos/$REPO_USER/$REPO_NAME/labels/good%20first%20issue
curl -u $TOKEN:x-oauth-basic --request DELETE https://api.github.com/repos/$REPO_USER/$REPO_NAME/labels/invalid
curl -u $TOKEN:x-oauth-basic --request DELETE https://api.github.com/repos/$REPO_USER/$REPO_NAME/labels/question
curl -u $TOKEN:x-oauth-basic --request DELETE https://api.github.com/repos/$REPO_USER/$REPO_NAME/labels/wontfix

# Create Type labels
curl -u $TOKEN:x-oauth-basic --include --request POST --data '{ "name": "Type: Bug", "color": "e11d21" }' "https://api.github.com/repos/$REPO_USER/$REPO_NAME/labels"
curl -u $TOKEN:x-oauth-basic --include --request POST --data '{ "name": "Type: Enhancement", "color": "84b6eb" }' "https://api.github.com/repos/$REPO_USER/$REPO_NAME/labels"
curl -u $TOKEN:x-oauth-basic --include --request POST --data '{ "name": "Type: Question", "color": "cc317c" }' "https://api.github.com/repos/$REPO_USER/$REPO_NAME/labels"

# Create Priority labels
curl -u $TOKEN:x-oauth-basic --include --request POST --data '{ "name": "Priority: Low", "color": "009800" }' "https://api.github.com/repos/$REPO_USER/$REPO_NAME/labels"
curl -u $TOKEN:x-oauth-basic --include --request POST --data '{ "name": "Priority: Medium", "color": "fbca04" }' "https://api.github.com/repos/$REPO_USER/$REPO_NAME/labels"
curl -u $TOKEN:x-oauth-basic --include --request POST --data '{ "name": "Priority: High", "color": "eb6420" }' "https://api.github.com/repos/$REPO_USER/$REPO_NAME/labels"
curl -u $TOKEN:x-oauth-basic --include --request POST --data '{ "name": "Priority: Critical", "color": "e11d21" }' "https://api.github.com/repos/$REPO_USER/$REPO_NAME/labels"

# Create Status labels
curl -u $TOKEN:x-oauth-basic --include --request POST --data '{ "name": "Status: Abandoned", "color": "000000" }' "https://api.github.com/repos/$REPO_USER/$REPO_NAME/labels"
curl -u $TOKEN:x-oauth-basic --include --request POST --data '{ "name": "Status: Accepted", "color": "009800" }' "https://api.github.com/repos/$REPO_USER/$REPO_NAME/labels"
curl -u $TOKEN:x-oauth-basic --include --request POST --data '{ "name": "Status: Available", "color": "bfe5bf" }' "https://api.github.com/repos/$REPO_USER/$REPO_NAME/labels"
curl -u $TOKEN:x-oauth-basic --include --request POST --data '{ "name": "Status: Blocked", "color": "e11d21" }' "https://api.github.com/repos/$REPO_USER/$REPO_NAME/labels"
curl -u $TOKEN:x-oauth-basic --include --request POST --data '{ "name": "Status: Completed", "color": "006b75" }' "https://api.github.com/repos/$REPO_USER/$REPO_NAME/labels"
curl -u $TOKEN:x-oauth-basic --include --request POST --data '{ "name": "Status: In Progress", "color": "cccccc" }' "https://api.github.com/repos/$REPO_USER/$REPO_NAME/labels"
curl -u $TOKEN:x-oauth-basic --include --request POST --data '{ "name": "Status: On Hold", "color": "e11d21" }' "https://api.github.com/repos/$REPO_USER/$REPO_NAME/labels"
curl -u $TOKEN:x-oauth-basic --include --request POST --data '{ "name": "Status: Pending", "color": "fef2c0" }' "https://api.github.com/repos/$REPO_USER/$REPO_NAME/labels"
curl -u $TOKEN:x-oauth-basic --include --request POST --data '{ "name": "Status: Review Needed", "color": "fbca04" }' "https://api.github.com/repos/$REPO_USER/$REPO_NAME/labels"
curl -u $TOKEN:x-oauth-basic --include --request POST --data '{ "name": "Status: Revision Needed", "color": "e11d21" }' "https://api.github.com/repos/$REPO_USER/$REPO_NAME/labels"
